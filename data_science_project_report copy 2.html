<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Science Project Report</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.20.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --text-color: #333;
            --background-color: #f9f9f9;
            --card-background: #ffffff;
            --border-color: #ecf0f1;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
            padding: 0;
            margin: 0;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 2rem 0;
            text-align: center;
            margin-bottom: 2rem;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        h2,
        h3,
        h4 {
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        h1 {
            font-size: 2.5rem;
        }

        h2 {
            font-size: 2rem;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.5rem;
            margin-top: 2rem;
        }

        h3 {
            font-size: 1.5rem;
            margin-top: 1.5rem;
        }

        p {
            margin-bottom: 1rem;
        }

        section {
            margin-bottom: 3rem;
        }

        .card {
            background-color: var(--card-background);
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 2rem;
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .visualization-container {
            margin: 2rem 0;
            height: 400px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .crossed-table {
            width: 45%;
            height: 700px;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        table th,
        table td {
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            text-align: center;
        }

        table th {
            background-color: var(--secondary-color);
            color: white;
        }

        table tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .enhanced-table {
            width: 100%;
            margin: 1rem 0;
            overflow-x: auto;
        }


        .code-block {
            background-color: #f8f9fa;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: monospace;
            overflow-x: auto;
            border-left: 4px solid var(--secondary-color);
        }


        .metrics-grid {
            display: flex;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        footer {
            background-color: var(--primary-color);
            color: white;
            text-align: center;
            padding: 2rem 0;
            margin-top: 3rem;
        }

        .highlight {
            color: var(--accent-color);
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .metrics-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            h1 {
                font-size: 2rem;
            }

            h2 {
                font-size: 1.75rem;
            }
        }

        @media (max-width: 480px) {
            .metrics-grid {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 1.75rem;
            }

            h2 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="container">
            <h1><b>Ariel</b></h1>
            <p>Modelo para Abertura de Conta performance Limite de conta e Cartao de Credito</p>
            <p><small>Gerado em <span id="generated-date"></span></small></p>
        </div>
    </header>

    <div class="container">
        <section id="executive-summary">
            <h2>Resumo</h2>
            <div class="card">
                <p>Esse relatorio apresenta os resultados do modelo desenvolvido para concessao de Limite de Conta e
                    Cartao de Credito na abertura de conta, bem como os mais recentes testes de combinacao com o Target
                </p>

                <div class="metrics-grid">
                    <div id="target_graph"></div>
                    <script>
                        const spec_tgt_graph = {
                            "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json",
                            "config": {
                                "view": {
                                    "continuousHeight": 300,
                                    "continuousWidth": 300
                                }
                            },
                            "data": {
                                "name": "data-967ed9054014cb22bdfb5881b0b768f3"
                            },
                            "datasets": {
                                "data-967ed9054014cb22bdfb5881b0b768f3": [
                                    {
                                        "Average_Exited": 0.21028836754643207,
                                        "Volume": 40920,
                                        "safra": 0
                                    },
                                    {
                                        "Average_Exited": 0.21324500132017954,
                                        "Volume": 41661,
                                        "safra": 1
                                    },
                                    {
                                        "Average_Exited": 0.21468207259362462,
                                        "Volume": 41629,
                                        "safra": 2
                                    },
                                    {
                                        "Average_Exited": 0.20808837938467567,
                                        "Volume": 40824,
                                        "safra": 3
                                    }
                                ]
                            },
                            "height": 200,
                            "layer": [
                                {
                                    "encoding": {
                                        "tooltip": [
                                            {
                                                "field": "safra",
                                                "type": "quantitative"
                                            },
                                            {
                                                "field": "Volume",
                                                "type": "quantitative"
                                            }
                                        ],
                                        "x": {
                                            "field": "safra",
                                            "type": "ordinal"
                                        },
                                        "y": {
                                            "field": "Volume",
                                            "type": "quantitative"
                                        }
                                    },
                                    "mark": {
                                        "type": "bar"
                                    }
                                },
                                {
                                    "encoding": {
                                        "tooltip": [
                                            {
                                                "field": "safra",
                                                "type": "quantitative"
                                            },
                                            {
                                                "field": "Average_Exited",
                                                "type": "quantitative"
                                            }
                                        ],
                                        "x": {
                                            "field": "safra",
                                            "type": "ordinal"
                                        },
                                        "y": {
                                            "field": "Average_Exited",
                                            "type": "quantitative"
                                        }
                                    },
                                    "mark": {
                                        "color": "red",
                                        "type": "line"
                                    }
                                }
                            ],
                            "resolve": {
                                "scale": {
                                    "y": "independent"
                                }
                            },
                            "title": "Monthly Volume and Average Exited",
                            "width": 400
                        };
                        const embedOpt_tgt_graph = { "actions": false };
                        vegaEmbed('#target_graph', spec_tgt_graph, embedOpt_tgt_graph).catch(console.error);
                    </script>

                    <div id="gini_mgl_res"></div>
                    <script>
                        const spec_gini_mgl_res = {
                            "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json",
                            "config": {
                                "view": {
                                    "continuousHeight": 300,
                                    "continuousWidth": 300
                                }
                            },
                            "data": {
                                "name": "data-8e51d217aaa022c7e4e8bb5e660fc62c"
                            },
                            "datasets": {
                                "data-8e51d217aaa022c7e4e8bb5e660fc62c": [
                                    {
                                        "Gini": 0.8279702138880887,
                                        "Model": "PROB_CHURN"
                                    },
                                    {
                                        "Gini": 0.5487801707117865,
                                        "Model": "REGR"
                                    },
                                    {
                                        "Gini": 0.8617775343334868,
                                        "Model": "PROB_CHURN_REGR"
                                    }
                                ]
                            },
                            "encoding": {
                                "tooltip": [
                                    {
                                        "field": "Model",
                                        "type": "nominal"
                                    },
                                    {
                                        "field": "Gini",
                                        "type": "quantitative"
                                    }
                                ],
                                "x": {
                                    "field": "Gini",
                                    "type": "quantitative"
                                },
                                "y": {
                                    "field": "Model",
                                    "sort": "-x",
                                    "type": "nominal"
                                }
                            },
                            "height": 200,
                            "mark": {
                                "type": "bar"
                            },
                            "title": "Gini Coefficients per Model",
                            "width": 200
                        }
                            ;
                        const embedOpt_gini_mgl_res = { "actions": false };
                        vegaEmbed('#gini_mgl_res', spec_gini_mgl_res, embedOpt_gini_mgl_res).catch(console.error);
                    </script>

                </div>
        </section>

        <section id="crossed_matrix">
            <h2>Matrix cruzada</h2>
            <div class="card">
                <p>O uso do modelo de abertura de conta e combinado com o Target, isso faz com que a discriminacao
                    individual do modelo nao seja o principal fator do sucesso ou nao da sua implementacao mas a
                    combinacao do <b>Target + Meridian</b></p>

                <h3>Target x Ariel</h3>
                <div class="metrics-grid" id="target-ariel">

                <table class="crossed-table">
                    <thead>
                      <tr style="text-align: right;">
                        <th>Qtd %</th>
                        <th>TG</th>
                        <th>TG_EX</th>
                        <th>NT_EX</th>
                        <th>NT</th>
                        <th>Total</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>A</th>
                        <td>6.8</td>
                        <td>2.2</td>
                        <td>0.9</td>
                        <td>0.1</td>
                        <td>10.0</td>
                      </tr>
                      <tr>
                        <th>B</th>
                        <td>8.6</td>
                        <td>1.2</td>
                        <td>0.2</td>
                        <td>0.0</td>
                        <td>10.0</td>
                      </tr>
                      <tr>
                        <th>C</th>
                        <td>6.8</td>
                        <td>2.8</td>
                        <td>0.3</td>
                        <td>0.0</td>
                        <td>10.0</td>
                      </tr>
                      <tr>
                        <th>D</th>
                        <td>2.4</td>
                        <td>6.8</td>
                        <td>0.8</td>
                        <td>0.0</td>
                        <td>10.0</td>
                      </tr>
                      <tr>
                        <th>E</th>
                        <td>0.3</td>
                        <td>7.7</td>
                        <td>2.0</td>
                        <td>0.0</td>
                        <td>10.0</td>
                      </tr>
                      <tr>
                        <th>F</th>
                        <td>0.1</td>
                        <td>3.9</td>
                        <td>5.9</td>
                        <td>0.1</td>
                        <td>10.0</td>
                      </tr>
                      <tr>
                        <th>G</th>
                        <td>0.0</td>
                        <td>0.4</td>
                        <td>9.0</td>
                        <td>0.6</td>
                        <td>10.0</td>
                      </tr>
                      <tr>
                        <th>H</th>
                        <td>0.0</td>
                        <td>0.0</td>
                        <td>5.3</td>
                        <td>4.6</td>
                        <td>10.0</td>
                      </tr>
                      <tr>
                        <th>I</th>
                        <td>0.0</td>
                        <td>0.0</td>
                        <td>0.5</td>
                        <td>9.5</td>
                        <td>10.0</td>
                      </tr>
                      <tr>
                        <th>J</th>
                        <td>0.0</td>
                        <td>0.0</td>
                        <td>0.0</td>
                        <td>10.0</td>
                        <td>10.0</td>
                      </tr>
                      <tr>
                        <th>Total</th>
                        <td>25.0</td>
                        <td>25.0</td>
                        <td>25.0</td>
                        <td>25.0</td>
                        <td>100.0</td>
                      </tr>
                    </tbody>
                  </table>
                  
                  <table class="crossed-table">
                    <thead>
                      <tr>
                        <th>Bad Rate</th>
                        <th>TG</th>
                        <th>TG_EX</th>
                        <th>NT_EX</th>
                        <th>NT</th>
                        <th>Total</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>A</th>
                        <td>0.00</td>
                        <td>0.01</td>
                        <td>0.03</td>
                        <td>0.05</td>
                        <td>0.0200</td>
                      </tr>
                      <tr>
                        <th>B</th>
                        <td>0.00</td>
                        <td>0.01</td>
                        <td>0.02</td>
                        <td>0.00</td>
                        <td>0.0100</td>
                      </tr>
                      <tr>
                        <th>C</th>
                        <td>0.01</td>
                        <td>0.01</td>
                        <td>0.03</td>
                        <td>0.00</td>
                        <td>0.0100</td>
                      </tr>
                      <tr>
                        <th>D</th>
                        <td>0.02</td>
                        <td>0.02</td>
                        <td>0.03</td>
                        <td>0.09</td>
                        <td>0.0400</td>
                      </tr>
                      <tr>
                        <th>E</th>
                        <td>0.04</td>
                        <td>0.04</td>
                        <td>0.04</td>
                        <td>0.08</td>
                        <td>0.0500</td>
                      </tr>
                      <tr>
                        <th>F</th>
                        <td>0.12</td>
                        <td>0.09</td>
                        <td>0.07</td>
                        <td>0.09</td>
                        <td>0.0900</td>
                      </tr>
                      <tr>
                        <th>G</th>
                        <td>0.25</td>
                        <td>0.26</td>
                        <td>0.14</td>
                        <td>0.11</td>
                        <td>0.1900</td>
                      </tr>
                      <tr>
                        <th>H</th>
                        <td>1.00</td>
                        <td>0.71</td>
                        <td>0.31</td>
                        <td>0.26</td>
                        <td>0.5700</td>
                      </tr>
                      <tr>
                        <th>I</th>
                        <td>0.00</td>
                        <td>1.00</td>
                        <td>0.69</td>
                        <td>0.60</td>
                        <td>0.5700</td>
                      </tr>
                      <tr>
                        <th>J</th>
                        <td>0.00</td>
                        <td>0.00</td>
                        <td>0.91</td>
                        <td>0.92</td>
                        <td>0.4600</td>
                      </tr>
                      <tr>
                        <th>Total</th>
                        <td>0.15</td>
                        <td>0.22</td>
                        <td>0.23</td>
                        <td>0.22</td>
                        <td>0.2116</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
        </section>

        <section id="exploratory-analysis">
            <h2>Exploratory Data Analysis</h2>
            <div class="card">
                <h3>Correlation Matrix</h3>
                <div class="visualization-container" id="correlation-heatmap"></div>

                <h3>Feature Importance</h3>
                <div class="visualization-container" id="feature-importance-chart"></div>
            </div>
        </section>

        <section id="model-performance">
            <h2>Model Performance</h2>
            <div class="card">
                <h3>Model Comparison</h3>
                <div class="visualization-container" id="model-comparison-chart"></div>

                <h3>Confusion Matrix</h3>
                <div class="visualization-container" id="confusion-matrix"></div>

                <h3>ROC Curve</h3>
                <div class="visualization-container" id="roc-curve"></div>

                <h3>Profit/Loss Analysis</h3>
                <div class="visualization-container" id="pnl-chart"></div>
            </div>
        </section>

        <section id="time-series-analysis">
            <h2>Time Series Analysis</h2>
            <div class="card">
                <h3>Temporal Patterns</h3>
                <div class="visualization-container" id="time-series-chart"></div>
            </div>
        </section>

        <section id="conclusions">
            <h2>Conclusions and Recommendations</h2>
            <div class="card">
                <p>Based on our analysis, we have identified several key insights:</p>
                <ul>
                    <li>Feature groups 1, 3, and 7 showed the strongest predictive power</li>
                    <li>The XGBoost model outperformed other algorithms consistently</li>
                    <li>Temporal patterns suggest potential for automated trading strategies</li>
                    <li>Feature engineering significantly improved model performance</li>
                </ul>

                <h3>Recommendations</h3>
                <ol>
                    <li>Implement the XGBoost model with the identified hyperparameters</li>
                    <li>Focus future feature engineering efforts on the most predictive feature groups</li>
                    <li>Explore ensemble methods to further improve model robustness</li>
                    <li>Deploy a monitoring system to track model drift in real-world conditions</li>
                </ol>
            </div>
        </section>
    </div>

    <footer>
        <div class="container">
            <p>Jane Street Market Prediction Analysis</p>
            <p>&copy; 2025 Data Science Team</p>
        </div>
    </footer>

    <script>
        // Set generated date
        document.getElementById('generated-date').textContent = new Date().toLocaleDateString('pt-BR', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        // Sample data for visualizations and tables
        const sampleDataStats = [
            { feature: 'feature_0', mean: 0.123, std: 0.456, min: -2.123, max: 2.456, missing: '0%' },
            { feature: 'feature_1', mean: -0.234, std: 1.123, min: -3.567, max: 3.890, missing: '0%' },
            { feature: 'feature_2', mean: 0.567, std: 0.789, min: -1.456, max: 2.345, missing: '0.2%' },
            { feature: 'feature_3', mean: 0.890, std: 0.567, min: -1.234, max: 2.678, missing: '0%' },
            { feature: 'feature_4', mean: -0.345, std: 1.456, min: -4.567, max: 3.980, missing: '0.1%' },
            { feature: 'feature_5', mean: 0.456, std: 0.234, min: -0.789, max: 1.234, missing: '0%' }
        ];

        // Populate the data stats table
        function populateDataStatsTable() {
            const table = document.getElementById('data-stats-table');

            let tableHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>Feature</th>
                            <th>Mean</th>
                            <th>Std</th>
                            <th>Min</th>
                            <th>Max</th>
                            <th>Missing Values</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            sampleDataStats.forEach(stat => {
                tableHTML += `
                    <tr>
                        <td>${stat.feature}</td>
                        <td>${stat.mean.toFixed(4)}</td>
                        <td>${stat.std.toFixed(4)}</td>
                        <td>${stat.min.toFixed(4)}</td>
                        <td>${stat.max.toFixed(4)}</td>
                        <td>${stat.missing}</td>
                    </tr>
                `;
            });

            tableHTML += `
                    </tbody>
                </table>
            `;

            table.innerHTML = tableHTML;
        }

        // Create feature distribution chart
        function createFeatureDistributionChart() {
            const ctx = document.createElement('canvas');
            ctx.id = 'feature-dist-canvas';
            ctx.style.width = '100%';
            ctx.style.height = '100%';
            document.getElementById('feature-distribution-chart').appendChild(ctx);

            const features = sampleDataStats.map(item => item.feature);
            const means = sampleDataStats.map(item => item.mean);
            const stds = sampleDataStats.map(item => item.std);

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: features,
                    datasets: [{
                        label: 'Mean Value',
                        data: means,
                        backgroundColor: 'rgba(52, 152, 219, 0.7)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 1
                    }, {
                        label: 'Standard Deviation',
                        data: stds,
                        backgroundColor: 'rgba(231, 76, 60, 0.7)',
                        borderColor: 'rgba(231, 76, 60, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Feature Distribution Summary'
                        },
                        legend: {
                            position: 'top'
                        }
                    }
                }
            });
        }

        // Create correlation heatmap
        function createCorrelationHeatmap() {
            const container = document.getElementById('correlation-heatmap');

            // Sample correlation data
            const features = ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5'];
            const correlationMatrix = [
                [1.00, 0.25, -0.10, 0.15, 0.05, 0.30],
                [0.25, 1.00, 0.45, -0.20, 0.35, -0.15],
                [-0.10, 0.45, 1.00, 0.50, 0.15, 0.25],
                [0.15, -0.20, 0.50, 1.00, -0.30, 0.40],
                [0.05, 0.35, 0.15, -0.30, 1.00, -0.05],
                [0.30, -0.15, 0.25, 0.40, -0.05, 1.00]
            ];

            const data = [{
                z: correlationMatrix,
                x: features,
                y: features,
                type: 'heatmap',
                colorscale: 'RdBu',
                zmin: -1,
                zmax: 1
            }];

            const layout = {
                title: 'Feature Correlation Matrix',
                xaxis: { title: '' },
                yaxis: { title: '' },
                margin: { t: 50, l: 80, r: 20, b: 80 }
            };

            Plotly.newPlot(container, data, layout, { responsive: true });
        }

        // Create feature importance chart
        function createFeatureImportanceChart() {
            const ctx = document.createElement('canvas');
            ctx.id = 'feature-imp-canvas';
            ctx.style.width = '100%';
            ctx.style.height = '100%';
            document.getElementById('feature-importance-chart').appendChild(ctx);

            // Sample feature importance data
            const features = sampleDataStats.map(item => item.feature);
            const importance = [0.32, 0.25, 0.18, 0.12, 0.08, 0.05];

            new Chart(ctx, {
                type: 'horizontalBar',
                data: {
                    labels: features,
                    datasets: [{
                        label: 'Feature Importance',
                        data: importance,
                        backgroundColor: 'rgba(46, 204, 113, 0.7)',
                        borderColor: 'rgba(46, 204, 113, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Feature Importance'
                        },
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // Create model comparison chart
        function createModelComparisonChart() {
            const ctx = document.createElement('canvas');
            ctx.id = 'model-comp-canvas';
            ctx.style.width = '100%';
            ctx.style.height = '100%';
            document.getElementById('model-comparison-chart').appendChild(ctx);

            // Sample model comparison data
            const models = ['XGBoost', 'LightGBM', 'Random Forest', 'Neural Network', 'Logistic Regression'];
            const accuracies = [0.857, 0.842, 0.831, 0.819, 0.795];
            const f1Scores = [0.809, 0.798, 0.782, 0.775, 0.753];

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: models,
                    datasets: [{
                        label: 'Accuracy',
                        data: accuracies,
                        backgroundColor: 'rgba(52, 152, 219, 0.7)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 1
                    },
                    {
                        label: 'F1 Score',
                        data: f1Scores,
                        backgroundColor: 'rgba(155, 89, 182, 0.7)',
                        borderColor: 'rgba(155, 89, 182, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 1.0
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Model Performance Comparison'
                        }
                    }
                }
            });
        }

        // Create confusion matrix
        function createConfusionMatrix() {
            const container = document.getElementById('confusion-matrix');

            // Sample confusion matrix data
            const cmData = [
                [423, 75],
                [91, 411]
            ];

            const data = [{
                z: cmData,
                x: ['Predicted Negative', 'Predicted Positive'],
                y: ['Actual Negative', 'Actual Positive'],
                type: 'heatmap',
                colorscale: 'Blues',
                showscale: false,
                text: [
                    ['TN: 423', 'FP: 75'],
                    ['FN: 91', 'TP: 411']
                ],
                texttemplate: "%{text}",
                textfont: { color: 'white' }
            }];

            const layout = {
                title: 'Confusion Matrix',
                margin: { t: 50, l: 140, r: 20, b: 140 },
                xaxis: { title: '' },
                yaxis: { title: '' }
            };

            Plotly.newPlot(container, data, layout, { responsive: true });
        }

        // Create ROC curve
        function createROCCurve() {
            const container = document.getElementById('roc-curve');

            // Sample ROC curve data
            const fpr = [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0];
            const tpr = [0, 0.4, 0.65, 0.75, 0.82, 0.87, 0.91, 0.94, 0.96, 0.98, 1.0];

            const data = [
                {
                    x: fpr,
                    y: tpr,
                    mode: 'lines',
                    type: 'scatter',
                    name: 'ROC Curve (AUC = 0.86)',
                    line: {
                        color: 'rgba(231, 76, 60, 0.8)',
                        width: 3
                    }
                },
                {
                    x: [0, 1],
                    y: [0, 1],
                    mode: 'lines',
                    type: 'scatter',
                    name: 'Random Classifier',
                    line: {
                        dash: 'dash',
                        color: 'rgba(180, 180, 180, 0.7)',
                        width: 2
                    }
                }
            ];

            const layout = {
                title: 'ROC Curve',
                xaxis: { title: 'False Positive Rate' },
                yaxis: { title: 'True Positive Rate' },
                legend: { x: 0.6, y: 0.2 },
                margin: { t: 50, r: 20, b: 50, l: 50 }
            };

            Plotly.newPlot(container, data, layout, { responsive: true });
        }

        // Create P&L chart
        function createPnLChart() {
            const container = document.getElementById('pnl-chart');

            // Sample P&L data
            const days = Array.from({ length: 30 }, (_, i) => i + 1);
            const cumulativePnL = [0];
            let current = 0;

            for (let i = 1; i < 30; i++) {
                // Random daily P&L with slightly positive bias
                const dailyChange = (Math.random() * 2 - 0.8) * 100;
                current += dailyChange;
                cumulativePnL.push(current);
            }

            const data = [
                {
                    x: days,
                    y: cumulativePnL,
                    type: 'scatter',
                    mode: 'lines',
                    name: 'Cumulative P&L',
                    line: {
                        color: 'rgba(46, 204, 113, 0.8)',
                        width: 3
                    }
                }
            ];

            const layout = {
                title: 'Cumulative Profit/Loss Over Time',
                xaxis: { title: 'Trading Day' },
                yaxis: { title: 'Cumulative P&L ($)' },
                margin: { t: 50, r: 20, b: 50, l: 80 }
            };

            Plotly.newPlot(container, data, layout, { responsive: true });
        }

        // Create time series chart
        function createTimeSeriesChart() {
            const container = document.getElementById('time-series-chart');

            // Generate sample time series data
            const dates = Array.from({ length: 60 }, (_, i) => {
                const date = new Date();
                date.setDate(date.getDate() - (60 - i));
                return date.toISOString().split('T')[0];
            });

            // Create some fake signal data with a pattern
            const signalValues = [];
            const predictionValues = [];

            for (let i = 0; i < 60; i++) {
                // Adding some cyclicality and trend
                const baseTrend = i * 0.05;
                const cyclical = 2 * Math.sin(i / 4);
                const noise = Math.random() * 2 - 1;

                signalValues.push(baseTrend + cyclical + noise);

                // Predictions lag by 1 day and are slightly smoothed
                if (i > 0) {
                    predictionValues.push(signalValues[i - 1] + (Math.random() * 0.6 - 0.3));
                } else {
                    predictionValues.push(null);
                }
            }

            const data = [
                {
                    x: dates,
                    y: signalValues,
                    type: 'scatter',
                    mode: 'lines',
                    name: 'Actual Signal',
                    line: {
                        color: 'rgba(52, 152, 219, 0.8)',
                        width: 2
                    }
                },
                {
                    x: dates,
                    y: predictionValues,
                    type: 'scatter',
                    mode: 'lines',
                    name: 'Predicted Signal',
                    line: {
                        color: 'rgba(231, 76, 60, 0.8)',
                        width: 2,
                        dash: 'dash'
                    }
                }
            ];

            const layout = {
                title: 'Signal Time Series Analysis',
                xaxis: { title: 'Date', tickangle: -45 },
                yaxis: { title: 'Signal Value' },
                legend: { x: 0.1, y: 0.9 },
                margin: { t: 50, r: 20, b: 100, l: 60 }
            };

            Plotly.newPlot(container, data, layout, { responsive: true });
        }

        // Initialize all visualizations when the page loads
        document.addEventListener('DOMContentLoaded', function () {
            // Create tables
            populateDataStatsTable();

            // Create charts
            createFeatureDistributionChart();
            createCorrelationHeatmap();
            createFeatureImportanceChart();
            createModelComparisonChart();
            createConfusionMatrix();
            createROCCurve();
            createPnLChart();
            createTimeSeriesChart();
        });

        // Update metrics with random variations when clicking on them (for demo purposes)
        document.querySelectorAll('.metric-card').forEach(card => {
            card.addEventListener('click', function () {
                const valueElement = this.querySelector('.metric-value');
                const currentValue = parseFloat(valueElement.textContent);
                const newValue = (currentValue + (Math.random() * 4 - 2)).toFixed(1) + '%';
                valueElement.textContent = newValue;
            });
        });

        // Function to load data from notebook (placeholder)
        // This function would be replaced with actual code to load data from the Jupyter notebook
        function loadDataFromNotebook() {
            // In a real implementation, you would use AJAX to load data from a server
            // that processes the notebook and extracts the data
            console.log("Loading data from test.ipynb...");

            // Here, you would parse the notebook data and update the visualizations
            // For now, we're using the sample data defined above
        }

        // Call the function to attempt loading notebook data
        loadDataFromNotebook();
    </script>
</body>

</html>